var dt=Object.create;var B=Object.defineProperty;var pt=Object.getOwnPropertyDescriptor;var mt=Object.getOwnPropertyNames;var vt=Object.getPrototypeOf,_t=Object.prototype.hasOwnProperty;var yt=s=>B(s,"__esModule",{value:!0});var P=(s,n)=>()=>(n||s((n={exports:{}}).exports,n),n.exports);var bt=(s,n,f)=>{if(n&&typeof n=="object"||typeof n=="function")for(let u of mt(n))!_t.call(s,u)&&u!=="default"&&B(s,u,{get:()=>n[u],enumerable:!(f=pt(n,u))||f.enumerable});return s},w=s=>bt(yt(B(s!=null?dt(vt(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var H=P((Mt,I)=>{var Et=function(){"use strict";function s(e,r){return r!=null&&e instanceof r}var n;try{n=Map}catch{n=function(){}}var f;try{f=Set}catch{f=function(){}}var u;try{u=Promise}catch{u=function(){}}function o(e,r,a,c,d){typeof r=="object"&&(a=r.depth,c=r.prototype,d=r.includeNonEnumerable,r=r.circular);var E=[],T=[],x=typeof Buffer!="undefined";typeof r=="undefined"&&(r=!0),typeof a=="undefined"&&(a=1/0);function v(l,b){if(l===null)return null;if(b===0)return l;var g,j;if(typeof l!="object")return l;if(s(l,n))g=new n;else if(s(l,f))g=new f;else if(s(l,u))g=new u(function(K,R){l.then(function(L){K(v(L,b-1))},function(L){R(v(L,b-1))})});else if(o.__isArray(l))g=[];else if(o.__isRegExp(l))g=new RegExp(l.source,i(l)),l.lastIndex&&(g.lastIndex=l.lastIndex);else if(o.__isDate(l))g=new Date(l.getTime());else{if(x&&Buffer.isBuffer(l))return Buffer.allocUnsafe?g=Buffer.allocUnsafe(l.length):g=new Buffer(l.length),l.copy(g),g;s(l,Error)?g=Object.create(l):typeof c=="undefined"?(j=Object.getPrototypeOf(l),g=Object.create(j)):(g=Object.create(c),j=c)}if(r){var Y=E.indexOf(l);if(Y!=-1)return T[Y];E.push(l),T.push(g)}s(l,n)&&l.forEach(function(K,R){var L=v(R,b-1),gt=v(K,b-1);g.set(L,gt)}),s(l,f)&&l.forEach(function(K){var R=v(K,b-1);g.add(R)});for(var y in l){var C;j&&(C=Object.getOwnPropertyDescriptor(j,y)),!(C&&C.set==null)&&(g[y]=v(l[y],b-1))}if(Object.getOwnPropertySymbols)for(var $=Object.getOwnPropertySymbols(l),y=0;y<$.length;y++){var A=$[y],k=Object.getOwnPropertyDescriptor(l,A);k&&!k.enumerable&&!d||(g[A]=v(l[A],b-1),k.enumerable||Object.defineProperty(g,A,{enumerable:!1}))}if(d)for(var U=Object.getOwnPropertyNames(l),y=0;y<U.length;y++){var z=U[y],k=Object.getOwnPropertyDescriptor(l,z);k&&k.enumerable||(g[z]=v(l[z],b-1),Object.defineProperty(g,z,{enumerable:!1}))}return g}return v(e,a)}o.clonePrototype=function(r){if(r===null)return null;var a=function(){};return a.prototype=r,new a};function p(e){return Object.prototype.toString.call(e)}o.__objToStr=p;function h(e){return typeof e=="object"&&p(e)==="[object Date]"}o.__isDate=h;function m(e){return typeof e=="object"&&p(e)==="[object Array]"}o.__isArray=m;function t(e){return typeof e=="object"&&p(e)==="[object RegExp]"}o.__isRegExp=t;function i(e){var r="";return e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),r}return o.__getRegExpFlags=i,o}();typeof I=="object"&&I.exports&&(I.exports=Et)});var W=P((J,G)=>{(function(){var s,n,f,u=[].splice,o=function(h,m){if(!(h instanceof m))throw new Error("Bound instance method accessed before binding")},p=[].indexOf;f=H(),s=require("events").EventEmitter,G.exports=n=function(){class h extends s{constructor(t={}){super();this.get=this.get.bind(this),this.mget=this.mget.bind(this),this.set=this.set.bind(this),this.mset=this.mset.bind(this),this.del=this.del.bind(this),this.take=this.take.bind(this),this.ttl=this.ttl.bind(this),this.getTtl=this.getTtl.bind(this),this.keys=this.keys.bind(this),this.has=this.has.bind(this),this.getStats=this.getStats.bind(this),this.flushAll=this.flushAll.bind(this),this.flushStats=this.flushStats.bind(this),this.close=this.close.bind(this),this._checkData=this._checkData.bind(this),this._check=this._check.bind(this),this._isInvalidKey=this._isInvalidKey.bind(this),this._wrap=this._wrap.bind(this),this._getValLength=this._getValLength.bind(this),this._error=this._error.bind(this),this._initErrors=this._initErrors.bind(this),this.options=t,this._initErrors(),this.data={},this.options=Object.assign({forceString:!1,objectValueSize:80,promiseValueSize:80,arrayValueSize:40,stdTTL:0,checkperiod:600,useClones:!0,deleteOnExpire:!0,enableLegacyCallbacks:!1,maxKeys:-1},this.options),this.options.enableLegacyCallbacks&&(console.warn("WARNING! node-cache legacy callback support will drop in v6.x"),["get","mget","set","del","ttl","getTtl","keys","has"].forEach(i=>{var e;e=this[i],this[i]=function(...r){var a,c,d,E;if(d=r,[...r]=d,[a]=u.call(r,-1),typeof a=="function")try{E=e(...r),a(null,E)}catch(T){c=T,a(c)}else return e(...r,a)}})),this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.validKeyTypes=["string","number"],this._checkData()}get(t){var i,e;if(o(this,h),(e=this._isInvalidKey(t))!=null)throw e;if(this.data[t]!=null&&this._check(t,this.data[t]))return this.stats.hits++,i=this._unwrap(this.data[t]),i;this.stats.misses++}mget(t){var i,e,r,a,c,d;if(o(this,h),!Array.isArray(t))throw i=this._error("EKEYSTYPE"),i;for(d={},r=0,c=t.length;r<c;r++){if(a=t[r],(e=this._isInvalidKey(a))!=null)throw e;this.data[a]!=null&&this._check(a,this.data[a])?(this.stats.hits++,d[a]=this._unwrap(this.data[a])):this.stats.misses++}return d}set(t,i,e){var r,a,c;if(o(this,h),this.options.maxKeys>-1&&this.stats.keys>=this.options.maxKeys)throw r=this._error("ECACHEFULL"),r;if(this.options.forceString&&!typeof i==="string"&&(i=JSON.stringify(i)),e==null&&(e=this.options.stdTTL),(a=this._isInvalidKey(t))!=null)throw a;return c=!1,this.data[t]&&(c=!0,this.stats.vsize-=this._getValLength(this._unwrap(this.data[t],!1))),this.data[t]=this._wrap(i,e),this.stats.vsize+=this._getValLength(i),c||(this.stats.ksize+=this._getKeyLength(t),this.stats.keys++),this.emit("set",t,i),!0}mset(t){var i,e,r,a,c,d,E,T,x,v;if(o(this,h),this.options.maxKeys>-1&&this.stats.keys+t.length>=this.options.maxKeys)throw i=this._error("ECACHEFULL"),i;for(r=0,E=t.length;r<E;r++){if(d=t[r],{key:c,val:v,ttl:x}=d,x&&typeof x!="number")throw i=this._error("ETTLTYPE"),i;if((e=this._isInvalidKey(c))!=null)throw e}for(a=0,T=t.length;a<T;a++)d=t[a],{key:c,val:v,ttl:x}=d,this.set(c,v,x);return!0}del(t){var i,e,r,a,c,d;for(o(this,h),Array.isArray(t)||(t=[t]),i=0,r=0,c=t.length;r<c;r++){if(a=t[r],(e=this._isInvalidKey(a))!=null)throw e;this.data[a]!=null&&(this.stats.vsize-=this._getValLength(this._unwrap(this.data[a],!1)),this.stats.ksize-=this._getKeyLength(a),this.stats.keys--,i++,d=this.data[a],delete this.data[a],this.emit("del",a,d.v))}return i}take(t){var i;return o(this,h),i=this.get(t),i!=null&&this.del(t),i}ttl(t,i){var e;if(o(this,h),i||(i=this.options.stdTTL),!t)return!1;if((e=this._isInvalidKey(t))!=null)throw e;return this.data[t]!=null&&this._check(t,this.data[t])?(i>=0?this.data[t]=this._wrap(this.data[t].v,i,!1):this.del(t),!0):!1}getTtl(t){var i,e;if(o(this,h),!!t){if((e=this._isInvalidKey(t))!=null)throw e;if(this.data[t]!=null&&this._check(t,this.data[t]))return i=this.data[t].t,i}}keys(){var t;return o(this,h),t=Object.keys(this.data),t}has(t){var i;return o(this,h),i=this.data[t]!=null&&this._check(t,this.data[t]),i}getStats(){return o(this,h),this.stats}flushAll(t=!0){o(this,h),this.data={},this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this._killCheckPeriod(),this._checkData(t),this.emit("flush")}flushStats(){o(this,h),this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.emit("flush_stats")}close(){o(this,h),this._killCheckPeriod()}_checkData(t=!0){var i,e,r;o(this,h),e=this.data;for(i in e)r=e[i],this._check(i,r);t&&this.options.checkperiod>0&&(this.checkTimeout=setTimeout(this._checkData,this.options.checkperiod*1e3,t),this.checkTimeout!=null&&this.checkTimeout.unref!=null&&this.checkTimeout.unref())}_killCheckPeriod(){if(this.checkTimeout!=null)return clearTimeout(this.checkTimeout)}_check(t,i){var e;return o(this,h),e=!0,i.t!==0&&i.t<Date.now()&&(this.options.deleteOnExpire&&(e=!1,this.del(t)),this.emit("expired",t,this._unwrap(i))),e}_isInvalidKey(t){var i;if(o(this,h),i=typeof t,p.call(this.validKeyTypes,i)<0)return this._error("EKEYTYPE",{type:typeof t})}_wrap(t,i,e=!0){var r,a,c,d;return o(this,h),this.options.useClones||(e=!1),a=Date.now(),r=0,d=1e3,i===0?r=0:i?r=a+i*d:this.options.stdTTL===0?r=this.options.stdTTL:r=a+this.options.stdTTL*d,c={t:r,v:e?f(t):t}}_unwrap(t,i=!0){return this.options.useClones||(i=!1),t.v!=null?i?f(t.v):t.v:null}_getKeyLength(t){return t.toString().length}_getValLength(t){return o(this,h),typeof t=="string"?t.length:this.options.forceString?JSON.stringify(t).length:Array.isArray(t)?this.options.arrayValueSize*t.length:typeof t=="number"?8:typeof(t!=null?t.then:void 0)=="function"?this.options.promiseValueSize:(typeof Buffer!="undefined"&&Buffer!==null?Buffer.isBuffer(t):void 0)?t.length:t!=null&&typeof t=="object"?this.options.objectValueSize*Object.keys(t).length:typeof t=="boolean"?8:0}_error(t,i={}){var e;return o(this,h),e=new Error,e.name=t,e.errorcode=t,e.message=this.ERRORS[t]!=null?this.ERRORS[t](i):"-",e.data=i,e}_initErrors(){var t,i,e;o(this,h),this.ERRORS={},e=this._ERRORS;for(i in e)t=e[i],this.ERRORS[i]=this.createErrorMessage(t)}createErrorMessage(t){return function(i){return t.replace("__key",i.type)}}}return h.prototype._ERRORS={ENOTFOUND:"Key `__key` not found",ECACHEFULL:"Cache max keys amount exceeded",EKEYTYPE:"The key argument has to be of type `string` or `number`. Found: `__key`",EKEYSTYPE:"The keys argument has to be an array.",ETTLTYPE:"The ttl argument has to be a number."},h}.call(this)}).call(J)});var Z=P((Q,X)=>{(function(){var s;s=X.exports=W(),s.version="5.1.2"}).call(Q)});var rt=P((Ht,st)=>{st.exports=function(n,f){for(var u=n.split("."),o=f.split("."),p=0;p<3;p++){var h=Number(u[p]),m=Number(o[p]);if(h>m)return 1;if(m>h)return-1;if(!isNaN(h)&&isNaN(m))return 1;if(isNaN(h)&&!isNaN(m))return-1}return 0}});var ot=P((Jt,nt)=>{var Ct=rt();nt.exports=function(n,f){var f=f||{},u=n.engines.node.replace(">=",""),o=process.version.replace("v","");Ct(o,u)===-1&&(f.message?console.error(f.message(u)):console.error(n.name+" requires at least version "+u+" of Node, please upgrade"),f.hasOwnProperty("exitCode")?process.exit(f.exitCode):process.exit(1))}});var at=w(require("commander")),ht=w(require("axios")),D=w(require("path")),O=w(require("fs")),lt=w(require("os")),ft=w(require("inquirer")),M=w(require("chalk"));var N=w(Z()),V=new N.default({stdTTL:3600});function tt(s,n){return V.mset([{key:"appKey",val:s},{key:"secret",val:n}])}function q(s){return V.get(s)}function et(){V.del(["appKey","secret"])}var{createHash:wt}=require("crypto");function Tt(s){let n=wt("sha256");return n.update(s),n.digest("hex")}function it(s,n,f,u,o){return Tt(n+xt(s)+f+u+o)}function xt(s){var n=s.length;return n<=20?s:s.substring(0,10)+n+s.substring(n-10,n)}var Ot="tlt",kt="a translate tool can be used in cli",St="1.0.0",jt=!0,Kt="https://github.com/wood3n/tlt.git",Rt="\u738B\u51EF <wangkka1@163.com>",Lt="MIT",Pt={node:">=16.13"},Dt={axios:"^0.24.0",chalk:"^4.1.2",commander:"^8.3.0",esbuild:"^0.13.15",inquirer:"^8.2.0","node-cache":"^5.1.2","please-upgrade-node":"^3.2.0","ts-node":"^10.4.0",typescript:"^4.5.2"},At="./bin/tlt.js",zt={dev:"ts-node scripts/index.ts",build:"node esbuild.config"},It={"@types/inquirer":"^8.1.3","@types/node":"^16.11.9","esbuild-node-externals":"^1.4.0"},F={name:Ot,description:kt,version:St,private:jt,repository:Kt,author:Rt,license:Lt,engines:Pt,dependencies:Dt,bin:At,scripts:zt,devDependencies:It};var S=`${(0,lt.homedir)()}${D.default.sep}tlt`;async function ut(s,n,f){let u=Math.round(new Date().getTime()/1e3),o=new Date().getTime();return ht.default.get("https://openapi.youdao.com/api",{params:{q:s,from:"auto",to:"auto",appKey:n,salt:o,sign:it(s,n,o,u,f),signType:"v3",curtime:u}})}function ct(){if(O.default.existsSync(S)){let s=O.default.readFileSync(`${S}${D.default.sep}config.json`,"utf8");if(s)return JSON.parse(s)}return null}function Bt(s,n){O.default.existsSync(S)||O.default.mkdirSync(S),O.default.writeFile(`${S}${D.default.sep}config.json`,JSON.stringify({appKey:s,secret:n}),"utf8",()=>{tt(s,n)})}function Vt(){O.default.rm(`${S}${D.default.sep}config.json`,{force:!0},()=>{et(),process.exit(1)})}function qt(s){var u,o;let n=q("appKey")||((u=ct())==null?void 0:u.appKey),f=q("secret")||((o=ct())==null?void 0:o.secret);!n||!f?ft.default.prompt([{type:"input",name:"appKey",message:"youdao translation service appKey"},{type:"input",name:"secret",message:"youdao translation service secret"}]).then(({appKey:p,secret:h})=>{ut(s,p,h).then(m=>{var t,i,e;Bt(p,h),console.log(M.default.green(`\u{1F389}\u{1F389}\u{1F389}${(e=(i=(t=m==null?void 0:m.data)==null?void 0:t.translation)==null?void 0:i[0])!=null?e:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))}).catch(m=>console.log(m))}):ut(s,n,f).then(p=>{var h,m,t;console.log(M.default.green(`\u{1F389}\u{1F389}\u{1F389}${(t=(m=(h=p==null?void 0:p.data)==null?void 0:h.translation)==null?void 0:m[0])!=null?t:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))})}(function(){ot()(F),new at.Command().version(F.version).name("\u{1F916}tlt\u{1F916}").command("tlt [query]","some query text").option("-rm --remove","reset your own appKey and secret").action((n,f)=>{n.remove?Vt():f.args.length&&qt(f.args[0])}).parse(process.argv)})();
