var C=Object.create;var f=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var H=e=>f(e,"__esModule",{value:!0});var J=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of O(t))!F.call(e,n)&&n!=="default"&&f(e,n,{get:()=>t[n],enumerable:!(r=q(t,n))||r.enumerable});return e},i=e=>J(H(f(e!=null?C(D(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var x=i(require("commander")),b=i(require("axios")),g=i(require("path")),c=i(require("fs")),$=i(require("os")),k=i(require("inquirer")),m=i(require("chalk")),S=i(require("cowsay"));var{createHash:K}=require("crypto");function N(e){let t=K("sha256");return t.update(e),t.digest("hex")}function w(e,t,r,n,a){return N(t+I(e)+r+n+a)}function I(e){var t=e.length;return t<=20?e:e.substring(0,10)+t+e.substring(t-10,t)}var M="tlt",U="a translate tool can be used in cli",_="1.0.0",A=!0,E="https://github.com/wood3n/tlt.git",G="\u738B\u51EF <wangkka1@163.com>",P="MIT",R={node:">=16.13"},z={axios:"^0.24.0",chalk:"^4.1.2",commander:"^8.3.0",cowsay:"^1.5.0",esbuild:"^0.13.15",inquirer:"^8.2.0","please-upgrade-node":"^3.2.0","ts-node":"^10.4.0",typescript:"^4.5.2"},B="./bin/tlt.js",L={dev:"ts-node scripts/index.ts",build:"node esbuild.config"},Q={"@types/inquirer":"^8.1.3","@types/node":"^16.11.9","esbuild-node-externals":"^1.4.0"},y={name:M,description:U,version:_,private:A,repository:E,author:G,license:P,engines:R,dependencies:z,bin:B,scripts:L,devDependencies:Q};var d=`${(0,$.homedir)()}${g.default.sep}tlt`;async function T(e,t,r){let n=Math.round(new Date().getTime()/1e3),a=new Date().getTime();return b.default.get("https://openapi.youdao.com/api",{params:{q:e,from:"auto",to:"auto",appKey:t,salt:a,sign:w(e,t,a,n,r),signType:"v3",curtime:n}})}function j(){let e=`${d}${g.default.sep}config.json`;if(c.default.existsSync(e)){let t=c.default.readFileSync(e,"utf8");if(t)return JSON.parse(t)}return null}function V(e,t){c.default.existsSync(d)||c.default.mkdirSync(d),c.default.writeFile(`${d}${g.default.sep}config.json`,JSON.stringify({appKey:e,secret:t}),"utf8",()=>{})}function W(){c.default.rm(`${d}${g.default.sep}config.json`,{force:!0},()=>{process.exit(1)})}function X(e){var n,a;let t=(n=j())==null?void 0:n.appKey,r=(a=j())==null?void 0:a.secret;!t||!r?(console.log(m.default.blue(S.default.say({text:"Thanks for using tlt, confirm that you have registered your own application in youdao translation public service, the address is https://ai.youdao.com/gw.s#/",e:"oO",T:"U "}))),k.default.prompt([{type:"password",name:"appKey",message:"youdao translation service appKey"},{type:"password",name:"secret",message:"youdao translation service secret"}]).then(({appKey:p,secret:l})=>{console.log(m.default.green("\u914D\u7F6E\u5B8C\u6210")),T(e,p,l).then(s=>{var u,h,v;V(p,l),console.log(m.default.green(`${(v=(h=(u=s==null?void 0:s.data)==null?void 0:u.translation)==null?void 0:h[0])!=null?v:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))}).catch(s=>console.log(s))})):T(e,t,r).then(p=>{var l,s,u;console.log(m.default.green(`${(u=(s=(l=p==null?void 0:p.data)==null?void 0:l.translation)==null?void 0:s[0])!=null?u:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))})}(function(){require("please-upgrade-node")(y),new x.Command().version(y.version).name("\u{1F916}tlt\u{1F916}").command("tlt [query]","some query text").option("-rm --remove","reset your own appKey and secret").action((t,r)=>{t.remove?W():r.args.length&&X(r.args[0])}).parse(process.argv)})();
