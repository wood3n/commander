var C=Object.create;var f=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,F=Object.prototype.hasOwnProperty;var H=e=>f(e,"__esModule",{value:!0});var J=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of O(t))!F.call(e,n)&&n!=="default"&&f(e,n,{get:()=>t[n],enumerable:!(r=q(t,n))||r.enumerable});return e},s=e=>J(H(f(e!=null?C(D(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var b=s(require("commander")),x=s(require("axios")),m=s(require("path")),c=s(require("fs")),$=s(require("os")),k=s(require("inquirer")),u=s(require("chalk")),S=s(require("cowsay"));var{createHash:K}=require("crypto");function N(e){let t=K("sha256");return t.update(e),t.digest("hex")}function v(e,t,r,n,a){return N(t+I(e)+r+n+a)}function I(e){var t=e.length;return t<=20?e:e.substring(0,10)+t+e.substring(t-10,t)}var M="trt",U="a translation tool can be used in cli",_="1.1.0",A="https://github.com/wood3n/tlt#readme",E="https://github.com/wood3n/tlt.git",G="wood3n <wangkka1@163.com>",P="MIT",R=["lib/*.js"],z={node:">=16.13"},B={axios:"^0.24.0",chalk:"^4.1.2",commander:"^8.3.0",cowsay:"^1.5.0",esbuild:"^0.13.15",inquirer:"^8.2.0","please-upgrade-node":"^3.2.0","ts-node":"^10.4.0",typescript:"^4.5.2"},L="./bin/trt.js",Q={dev:"node ./config/esbuild.dev.config",build:"node ./config/esbuild.pro.config"},V={"@types/inquirer":"^8.1.3","@types/node":"^16.11.9","esbuild-node-externals":"^1.4.0"},h={name:M,description:U,version:_,homepage:A,repository:E,author:G,license:P,files:R,engines:z,dependencies:B,bin:L,scripts:Q,devDependencies:V};var d=`${(0,$.homedir)()}${m.default.sep}tlt`;async function T(e,t,r){let n=Math.round(new Date().getTime()/1e3),a=new Date().getTime();return x.default.get("https://openapi.youdao.com/api",{params:{q:e,from:"auto",to:"auto",appKey:t,salt:a,sign:v(e,t,a,n,r),signType:"v3",curtime:n}})}function j(){let e=`${d}${m.default.sep}config.json`;if(c.default.existsSync(e)){let t=c.default.readFileSync(e,"utf8");if(t)return JSON.parse(t)}return null}function W(e,t){c.default.existsSync(d)||c.default.mkdirSync(d),c.default.writeFile(`${d}${m.default.sep}config.json`,JSON.stringify({appKey:e,secret:t}),"utf8",()=>{})}function X(){c.default.rm(`${d}${m.default.sep}config.json`,{force:!0},()=>{process.exit(1)})}function Y(e){var n,a;let t=(n=j())==null?void 0:n.appKey,r=(a=j())==null?void 0:a.secret;!t||!r?(console.log(u.default.blue(S.default.say({text:"Thanks for using tlt, confirm that you have registered your own application in youdao translation public service, the address is https://ai.youdao.com/gw.s#/",e:"oO",T:"U "}))),k.default.prompt([{type:"password",name:"appKey",message:"youdao translation service appKey"},{type:"password",name:"secret",message:"youdao translation service secret"}]).then(({appKey:p,secret:g})=>{console.log(u.default.green("\u914D\u7F6E\u5B8C\u6210")),T(e,p,g).then(i=>{var l,y,w;W(p,g),console.log(u.default.green(`${(w=(y=(l=i==null?void 0:i.data)==null?void 0:l.translation)==null?void 0:y[0])!=null?w:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))}).catch(i=>console.log(i))})):T(e,t,r).then(p=>{var g,i,l;console.log(u.default.green(`${(l=(i=(g=p==null?void 0:p.data)==null?void 0:g.translation)==null?void 0:i[0])!=null?l:"\u672A\u67E5\u8BE2\u5230\u7FFB\u8BD1\u7ED3\u679C"}`))})}(function(){require("please-upgrade-node")(h),new b.Command().version(h.version).name("\u{1F916}tlt\u{1F916}").command("tlt [query]","some query text").option("-rm --remove","reset your own appKey and secret").action((t,r)=>{t.remove?X():r.args.length&&Y(r.args[0])}).parse(process.argv)})();
